/**
 * Password Meter Override - Fix Overlap with Toggle Button
 *
 * Issue: Odoo's auth_password_policy_portal positions the password meter
 * absolutely inside the input field (right: 5px), conflicting with our
 * password toggle button (right: 0px).
 *
 * Solution: Move meter below the input field (static positioning).
 *
 * UX Pattern: Follows Google, Microsoft, GitHub standards for password
 * strength indicators.
 *
 * Files modified:
 * - This file (new)
 * - __manifest__.py (add to assets)
 *
 * Odoo Core Files Overridden:
 * - auth_password_policy_portal/static/src/scss/portal_policy.scss
 * - auth_password_policy/static/src/css/password_field.css
 *
 * Related: Password toggle feature implementation
 * Testing: E2E tests in tests/e2e/password-toggle.spec.js
 */

// Override Odoo core meter positioning for portal security page
.o_portal_security_body #new-password-group {
  // Remove absolute positioning from meter
  // NOTE: This override targets Odoo v17 core styles (see portal_policy.scss, password_field.css)
  meter.o_password_meter {
    position: static !important;  // Override Odoo's absolute positioning
    display: block;
    width: 100%;
    height: 6px;  // Thinner bar (modern design, was 15px in core)
    margin-top: 8px;  // Space below input field
    margin-bottom: 4px;  // Space before next element
    right: auto !important;  // Reset core right: 5px
    bottom: auto !important;  // Reset core bottom: calc(50% - 7px)

    // Ensure meter is visible even with empty input
    // (Override core: input.o_field_password:placeholder-shown + meter { display: none; })
    display: block !important;
  }

  // Adjust input padding: Only account for toggle button (right side)
  // Meter is now below, so no left/right padding adjustment needed
  input[name="new1"] {
    padding-right: 34px !important;  // Space for toggle button (desktop: 34px)

    // Mobile: Larger touch target (44px)
    @media (max-width: 768px) {
      padding-right: 44px !important;
    }
  }
}

// Style meter colors to match Destock Info branding and Bootstrap
meter.o_password_meter {
  // WebKit browsers (Chrome, Safari, Edge)
  &::-webkit-meter-bar {
    background-color: #e9ecef;  // Bootstrap gray-200
    border-radius: 3px;
  }

  &::-webkit-meter-optimum-value {
    background-color: #28a745;  // Bootstrap success (strong password)
  }

  &::-webkit-meter-suboptimum-value {
    background-color: #ffc107;  // Bootstrap warning (medium password)
  }

  &::-webkit-meter-even-less-good-value {
    background-color: #dc3545;  // Bootstrap danger (weak password)
  }

  // Firefox meter styling
  &::-moz-meter-bar {
    border-radius: 3px;
  }
}

// High contrast mode support for accessibility
@media (prefers-contrast: high) {
  meter.o_password_meter {
    border: 2px solid #000;
  }
}

// Responsive adjustments for mobile
@media (max-width: 768px) {
  .o_portal_security_body #new-password-group {
    meter.o_password_meter {
      height: 8px;  // Slightly taller on mobile (easier to see)
      margin-top: 10px;  // More space on mobile
    }
  }
}

// Reduced motion support for accessibility
@media (prefers-reduced-motion: reduce) {
  meter.o_password_meter {
    transition: none !important;
  }
}
